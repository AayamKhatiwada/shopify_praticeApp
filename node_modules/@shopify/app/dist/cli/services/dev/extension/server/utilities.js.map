{"version":3,"file":"utilities.js","sourceRoot":"","sources":["../../../../../../src/cli/services/dev/extension/server/utilities.ts"],"names":[],"mappings":"AACA,OAAO,EAAC,yBAAyB,EAAE,qBAAqB,EAAC,MAAM,mDAAmD,CAAA;AAElH,OAAO,EAAC,IAAI,EAAC,MAAM,kBAAkB,CAAA;AAErC,MAAM,UAAU,cAAc,CAAC,SAAsB,EAAE,OAA4B;IACjF,MAAM,OAAO,GAAG,qBAAqB,CAAC,SAAS,CAAC,aAAa,CAAC,IAAI,CAAC,CAAA;IACnE,MAAM,EAAC,GAAG,EAAE,WAAW,EAAC,GAAG,yBAAyB,CAAC,SAAS,CAAC,aAAa,CAAC,IAAI,EAAE,OAAO,CAAC,CAAA;IAE3F,IAAI,OAAO,KAAK,UAAU,IAAI,WAAW,EAAE;QACzC,MAAM,MAAM,GAAG,IAAI,GAAG,CAAC,WAAW,OAAO,CAAC,SAAS,GAAG,CAAC,CAAA;QACvD,MAAM,CAAC,QAAQ,GAAG,WAAW,CAAA;QAC7B,MAAM,CAAC,YAAY,CAAC,MAAM,CAAC,KAAK,EAAE,GAAG,OAAO,CAAC,GAAG,aAAa,CAAC,CAAA;QAE9D,OAAO,MAAM,CAAC,QAAQ,EAAE,CAAA;KACzB;SAAM;QACL,MAAM,MAAM,GAAG,IAAI,GAAG,CAAC,WAAW,OAAO,CAAC,SAAS,GAAG,CAAC,CAAA;QACvD,MAAM,CAAC,QAAQ,GAAG,sBAAsB,CAAA;QACxC,MAAM,CAAC,YAAY,CAAC,MAAM,CAAC,KAAK,EAAE,eAAe,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC,CAAA;QAEtE,OAAO,MAAM,CAAC,QAAQ,EAAE,CAAA;KACzB;AACH,CAAC;AAED,MAAM,UAAU,eAAe,CAAC,SAAsB,EAAE,OAA4B;IAClF,MAAM,YAAY,GAAG,IAAI,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,CAAA;IACzC,YAAY,CAAC,QAAQ,GAAG,eAAe,SAAS,CAAC,OAAO,EAAE,CAAA;IAC1D,OAAO,YAAY,CAAC,QAAQ,EAAE,CAAA;AAChC,CAAC;AAED,MAAM,UAAU,SAAS,CAAC,QAA6B,EAAE,KAA4B;IACnF,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,EAAE,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,CAAA;AACzD,CAAC","sourcesContent":["import {UIExtension} from '../../../../models/app/extensions.js'\nimport {getUIExtensionResourceURL, getUIExtensionSurface} from '../../../../utilities/extensions/configuration.js'\nimport {ExtensionDevOptions} from '../../extension.js'\nimport {http} from '@shopify/cli-kit'\n\nexport function getRedirectUrl(extension: UIExtension, options: ExtensionDevOptions): string {\n  const surface = getUIExtensionSurface(extension.configuration.type)\n  const {url: resourceUrl} = getUIExtensionResourceURL(extension.configuration.type, options)\n\n  if (surface === 'checkout' && resourceUrl) {\n    const rawUrl = new URL(`https://${options.storeFqdn}/`)\n    rawUrl.pathname = resourceUrl\n    rawUrl.searchParams.append('dev', `${options.url}/extensions`)\n\n    return rawUrl.toString()\n  } else {\n    const rawUrl = new URL(`https://${options.storeFqdn}/`)\n    rawUrl.pathname = 'admin/extensions-dev'\n    rawUrl.searchParams.append('url', getExtensionUrl(extension, options))\n\n    return rawUrl.toString()\n  }\n}\n\nexport function getExtensionUrl(extension: UIExtension, options: ExtensionDevOptions): string {\n  const extensionUrl = new URL(options.url)\n  extensionUrl.pathname = `/extensions/${extension.devUUID}`\n  return extensionUrl.toString()\n}\n\nexport function sendError(response: http.ServerResponse, error: Partial<http.H3Error>) {\n  http.sendError(response.event, http.createError(error))\n}\n"]}